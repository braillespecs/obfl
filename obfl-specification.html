<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type"
  content="application/xhtml+xml; charset=UTF-8" />
  <title>OBFL - Open Braille Formatting Language</title>
  <meta name="dc:identifier" content="" />
  <meta name="dc:Title" content="OBFL Specification" />
  <meta name="dc:Language" content="en" />
  <meta name="dc:Date" content="2014-01-14" />
  <link rel="stylesheet" href="default.css" type="text/css" />
</head>

<body>
<h1>OBFL - Open Braille Formatting Language</h1>

<p>Working draft, revised January 14, 2014</p>
<dl>
  <dt><a id="thisVersion" name="thisVersion">This version</a>:</dt>
    <dd>N/A </dd>
  <dt>Author:</dt>
    <dd>Joel Håkansson</dd>
  <!--
        <dt>Contributors:</dt>
        <dd></dd>-->
</dl>

<h2 id="L62"><a class="mozTocH2" name="mozTocId823610"></a>Abstract</h2>

<p>This document specifies the Open Braille Formatting Language (OBFL), a data
format for representing text formatting layout. OBFL is an <a
href="#ref-xml">XML</a> 1.0 application.</p>

<h2 id="L71"><a class="mozTocH2" name="mozTocId427116"></a>Status of this
Document</h2>

<p>This document is a working draft.</p>

<h2 id="L77"><a class="mozTocH2" name="mozTocId469583"></a>Table of
Contents</h2>

<div class="toc">
<ul>
  <li><a href="#L255">Introduction</a> 
    <ul>
      <li><a href="#L261">What is OBFL?</a></li>
      <li><a href="#L265">Why is OBFL Necessary?</a></li>
      <li><a href="#L279">Scope Limitations</a></li>
    </ul>
  </li>
  <li><a href="#L287">Definitions</a> 
    <ul>
      <li><a href="#L295">Terminology</a></li>
      <li><a href="#L302">General Terms</a></li>
      <li><a href="#L425">Axes and Node Types</a></li>
      <li><a href="#L449">Relationship to Other Specifications</a></li>
    </ul>
  </li>
  <li><a href="#L453">Definition of OBFL</a> 
    <ul>
      <li><a href="#L459">Document Conformance </a></li>
      <li><a href="#L493">Using OBFL with Other Namespaces</a></li>
      <li><a href="#L501">Internet Media Type and File Extension</a></li>
    </ul>
  </li>
  <li><a href="#L507">Evaluation language</a> 
    <ul>
      <li><a href="#L509">Background</a></li>
      <li><a href="#L520">Specification</a> 
        <ul>
          <li><a href="#L3791">Numerical and Logical Operators</a></li>
          <li><a href="#L3682">Keyword Operators</a></li>
          <li><a href="#L14889">Keywords</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#L558">Elements</a> 
    <ul>
      <li><a href="#L565">obfl</a></li>
      <li><a href="#L587">meta</a></li>
      <li><a href="#L5871">layout-master</a></li>
      <li><a href="#L608">template, default-template</a></li>
      <li><a href="#L629">header</a></li>
      <li><a href="#L647">footer</a></li>
      <li><a href="#L665">field</a></li>
      <li><a href="#L683">marker-reference</a></li>
      <li><a href="#L696">string</a></li>
      <li><a href="#L709">current-page</a></li>
      <li><a href="#L722">evaluate</a></li>
      <li><a href="#L735">table-of-contents</a></li>
      <li><a href="#L1105">toc-entry</a></li>
      <li><a href="#L1207">leader</a></li>
      <li><a href="#L1353">marker</a></li>
      <li><a href="#L1438">br</a></li>
      <li><a href="#L1505">evaluate</a></li>
      <li><a href="#L836">page-number</a></li>
      <li><a href="#L849">volume-template</a> 
        <ul>
          <li><a href="#L15164">Attributes</a></li>
        </ul>
      </li>
      <li><a href="#L870">pre-content</a></li>
      <li><a href="#L888">post-content</a></li>
      <li><a href="#L906">sequence</a></li>
      <li><a href="#L924">toc-sequence</a> 
        <ul>
          <li><a href="#L15262">Attributes</a></li>
        </ul>
      </li>
      <li><a href="#L951">on-toc-start</a></li>
      <li><a href="#L969">on-volume-start</a></li>
      <li><a href="#L987">on-volume-end</a></li>
      <li><a href="#L1005">on-toc-end</a></li>
      <li><a href="#L1023">block</a> 
        <ul>
          <li><a href="#L15385">Attributes</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#L1194">content-items</a></li>
  <li><a href="#L1210">content-item</a></li>
  <li><a href="#L756">Rule Sets</a> 
    <ul>
      <li><a href="#L763">DTD Rule Set</a></li>
      <li><a href="#L774">XML Schema Rule Set</a></li>
    </ul>
  </li>
  <li><a href="#L784">References</a> 
    <ul>
      <li><a href="#L786">Normative References</a></li>
      <li><a href="#L881">Informative References</a></li>
    </ul>
  </li>
</ul>
</div>

<h2 id="L255">Introduction</h2>

<p><strong>This section is informative.</strong> </p>

<h3 id="L261">What is OBFL?</h3>

<p>The Open Braille Formatting Language (OBFL) is a document type that
represents text formatting layout. It can be used for braille and other fixed
character width contexts.</p>

<h3 id="L265">Why is OBFL Necessary?</h3>

<p>OBFL brings a number of things to braille production:</p>
<ul>
  <li>A braille formatting standard.</li>
  <li>Separation of authoring formats and braille formatting enables a more
    efficient formatter design.</li>
  <li>Economy. Work on input format interpretation can be migrated to a other
    braille formatters supporting OBFL.</li>
</ul>

<h3 id="L279">Scope Limitations</h3>

<p>OBFL is a braille formatting language. This includes areas specific to
braille formatting, such as volume splitting. However, there are many other
issues in braille production that OBFL neither can nor should solve. For
example, issues involving controlling text to braille translations (except by
means of formatting related abstractions).</p>

<h2 id="L287">Definitions</h2>

<p><strong>This section is normative.</strong> </p>

<p>The following terms and definitions are used within this document.</p>

<h3 id="L295">Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in <a href="#ref-rfc2119">RFC 2119</a>.</p>

<h3 id="L302">General Terms</h3>
<dl>
  <dt>Document</dt>
    <dd>A document is a stream of data that, after being combined with any
      other streams it references, is structured such that it holds information
      contained within <span class="term">elements</span>, that are organized
      as defined in an associated <span class="term">schema</span>. See <a
      href="#docconf">Document Conformance</a> for more information.</dd>
  <dt><a name="facilities" id="facilities">Facilities</a></dt>
    <dd>Facilities are <span class="term">elements</span>, <span
      class="term">attributes</span>, and the semantics associated with those
      <span class="term">elements</span> and <span
      class="term">attributes</span>.</dd>
  <dt>Implementation</dt>
    <dd>See User agent.</dd>
  <dt>Parsing</dt>
    <dd>Parsing is the act whereby a <span class="term">document</span> is
      read, and the information contained within the <span
      class="term">document</span> is filtered into the context of the <span
      class="term">elements</span> in which the information is structured.</dd>
  <dt>Rendering</dt>
    <dd>See <a
      href="http://www.w3.org/TR/di-gloss/#def-rendering">definition</a> in
      Device Independence Glossary document [<a href="#ref-digloss">DI
      Glossary</a>].</dd>
  <dt>Schema</dt>
    <dd>A schema is a collection of markup rules that, as a collection, define
      the legal structure, <span class="term">elements</span>, and <span
      class="term">attributes</span> available for use in an XML document that
      complies to the defined schema.</dd>
  <dt>User agent</dt>
    <dd>See <a
      href="http://www.w3.org/TR/di-gloss/#def-user-agent">definition</a> in
      Device Independence Glossary document [<a href="#ref-digloss">DI
      Glossary</a>].</dd>
  <dt>Validation</dt>
    <dd>Validation is a process whereby <span class="term">documents</span> are
      verified against the associated <span class="term">schema</span>,
      ensuring that the structure, use of <span class="term">elements</span>,
      and use of <span class="term">attributes</span> are consistent with the
      definitions in the <span class="term">schema</span>.</dd>
  <dt><a name="wellformed" id="wellformed">Well-formed</a> </dt>
    <dd>A <span class="term">document</span> is well-formed when it is
      structured according to the rules defined in <a
      href="http://www.w3.org/TR/REC-xml#sec-well-formed">Section 2.1</a> of
      the XML 1.0 Recommendation [<a class="nref" href="#ref-xml">XML</a>].</dd>
</dl>

<h3 id="L425">Axes and Node Types</h3>

<p>The use of <dfn>axes</dfn> in this document (such as "child", "parent",
"ancestor", "descendant") is consistent with <a
href="http://www.w3.org/TR/xpath#axes">Section 2.2</a> of the XPath 1.0
Recommendation [<a class="nref" href="#ref-xpath">XPath</a>].</p>

<p>The use of <dfn>node types</dfn> in this document (such as "root",
"element", "text", "attribute") is consistent with <a
href="http://www.w3.org/TR/xpath#data-model">Section 5</a> of the XPath 1.0
Recommendation [<a class="nref" href="#ref-xpath">XPath</a>].</p>

<h3 id="L449">Relationship to Other Specifications</h3>

<p>This specification is based on the specific versions of the standards and
specifications referenced herein, which are used as defined except as noted in
this document. Any refinement or replacement of a referenced specification by a
newer or different version is not directly applicable to this standard.
Conformance to this standard is based on the versions of the standards and
specifications in effect at the time of writing.</p>

<h2 id="L453">Definition of OBFL</h2>

<p><strong>This section is normative.</strong> </p>

<h3 id="L459"><a name="docconf" id="docconf">Document Conformance</a> </h3>

<p>A conforming OBFL document is an XML document that requires only the
facilities described as mandatory in this specification. Such a document must
meet all of the following criteria:</p>
<ol class="plain">
  <li>It must conform to the constraints associated with the namespaces used in
    it.<br />
  </li>
  <li>The local part of the root element of the document must be
    <dfn>obfl</dfn>.</li>
  <li>The root element of the document must be in the OBFL namespace.</li>
  <li>The start tag of the root element of the document must contain an xmlns
    declaration for the OBFL namespace [<a href="#ref-xmlns">XMLNS</a>]. The
    namespace URI for OBFL is defined to be
    <dfn>http://www.daisy.org/ns/2011/obfl</dfn>. An example root element might
    look like: &lt;obfl version="2011-1"
    xmlns="http://www.daisy.org/ns/2011/obfl"</li>
</ol>

<h3 id="L493"><a name="Using1" id="Using1">Using OBFL with Other
Namespaces</a></h3>

<p>The OBFL namespace may be used with other XML namespaces as per [<a
href="#ref-xmlns">XMLNS</a>].</p>

<h3 id="L501">Internet Media Type and File Extension</h3>

<p>The Internet media type for OBFL is "application/x-obfl+xml".</p>

<p>It is recommended that OBFL files have the extension ".obfl" (all lowercase)
on all platforms.</p>

<h2 id="L507">Evaluation language</h2>

<h3 id="L509">Background</h3>

<p><strong>This section is informative.</strong></p>

<p>Ideally, all logic should be handled in pre-processing, and the formatting
document should be fixed. However, this was not possible in this case, as some
descisions had to be made based on the result of the formatting, such as the
volume or page of an element. Therefore, an evaluation language was needed for
the formatting process.</p>

<p>An attempt was made at finding an existing language. However, none seemed to
suit the specific needs in this context. Either the proposed language contained
a vast number of operations that would carry an unclear meaning (such as XPath)
or it was too powerful for the situation (full-fledged scripting languages).
Others were simply too obscure.</p>

<p>What was needed was simple logical tests and a conditional construct. Hence,
the OBFL evaluation language was created.</p>

<h3 id="L520">Specification</h3>

<p><strong>This section is normative.</strong></p>

<p>The OBFL evaluation language uses prefix notation, i.e. the operator comes
first and the arguments follow. The arguments are separated by whitespace. Each
operation and its arguments must be surrounded with parenthesis, including the
outermost expression.</p>

<p>An argument can contain whitespace if it is surrounded by quotes.</p>

<h4 id="L3791">Numerical and Logical Operators</h4>

<p>The following operators exist: +, -, *, /, %, =, &lt;, &lt;=, &gt;, &gt;=,
&amp;, |, !</p>

<p>All numerical and logical operators require at least two arguments, but
accepts an unspecified number of arguments. The arguments of logical operators
are processed one at a time evaluating each argument against the previous in
the list. Numerical arguments are evaluated against the current result. For
example <code>(/ 20 5 4)</code> evaluates to 1.</p>

<h4 id="L3682">Keyword Operators</h4>
<dl>
  <dt>if</dt>
    <dd>if takes three arguments: the expression to test (must evaluate to a
      boolean), value when true, value when false</dd>
  <dt>round</dt>
    <dd>round takes one argument: the value to round (must be a number)</dd>
</dl>

<h4 id="L14889">Keywords</h4>

<p>Keywords supplied in a specific OBFL context are used by prefixing the name
of the keyword with $. For example, the default keyword for
volume-number-variable is volume. This could be used in an expression such as
<code>(= $volume 1)</code>. <code></code></p>

<h2 id="L558">Elements</h2>

<p><strong>This section is informative.</strong></p>

<p>Elements are listed in document order. In this listing, unprefixed elements
are in the OBFL namespace.</p>

<p>The top level element structure of an OBFL document is as follows:</p>
<pre>&lt;obfl&gt;
  &lt;meta&gt;...&lt;/meta&gt;
  &lt;layout-master&gt;...&lt;/layout-master&gt;
  &lt;table-of-contents&gt;...&lt;/table-of-contents&gt;
  &lt;volume-template&gt;...&lt;/volume-template&gt;
  &lt;content-items&gt;...&lt;/content-items&gt;
  &lt;sequence&gt;...&lt;/sequence&gt;
&lt;/obfl&gt;</pre>

<h3 id="L565">obfl</h3>

<p>The obfl element is the root element of a OBFL document.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>The obfl element is the root element of an OBFL document.</dd>
  <dt>Content Model</dt>
    <dd>meta (optional)</dd>
    <dd>layout-master (one or more)</dd>
    <dd>table-of-contents (zero or more)</dd>
    <dd>volume-template (zero or more)</dd>
    <dd>content-items (zero or more)</dd>
    <dd>sequence (one or more)</dd>
</dl>
</div>

<h3 id="L587">meta</h3>

<p>The meta element contains meta data, e.g. Dublin Core. Currently, any
element is allowed, however a stricter set of elements might be more useful.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>obfl</dd>
  <dt>Content Model</dt>
    <dd>Elements from any namespace. (zero or more)</dd>
</dl>
</div>

<h3 id="L5871">layout-master</h3>

<p>The layout-master element defines the appearence of pages in the sequences
where the layout-master is applied. It contains page template information, such
as the width and height of pages.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>obfl</dd>
   <dt>Attributes</dt>
   <dd>
	   <dl>
			   <dt>duplex</dt>
				<dt>inner-margin</dt>
				<dt>outer-margin</dt>
				<dt>page-height</dt>
				<dt>page-number-variable</dt>
				<dt>page-width</dt>
				<dt>row-spacing</dt>
		</dl>
		<p>This element supports the <a href="#borders">Borders</a> attribute group.</p>
   </dd>
  <dt>Content Model</dt>
    <dd>template (zero or more)</dd>
    <dd>default-template (required)</dd>
</dl>
</div>

<h3 id="L608">template, default-template</h3>

<p>The template element contains template information that applies under
specific conditions. The template conditions are tested in document order, and
the first template whose condition returns true is applied. The
default-template element contains the same type of information as the template
element and acts as a fallback when no previous template element applies.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>layout-master</dd>
  <dt>Content Model</dt>
    <dd>header (required)</dd>
    <dd>footer (required)</dd>
</dl>
</div>

<h3 id="L629">header</h3>

<p>The header element contains the page header information. The chunks of text
created when resolving each child elements contents are distributed in an equal
spaced cell grid over a single row.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>template, default-template</dd>
  <dt>Content Model</dt>
    <dd>field (zero or more)</dd>
</dl>
</div>

<h3 id="L647">footer</h3>

<p>The footer element contains the page footer information. The chunks of text
created when resolving each child elements contents are distributed in an equal
spaced cell grid over a single row.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>template, default-template</dd>
  <dt>Content Model</dt>
    <dd>field (zero or more)</dd>
</dl>
</div>

<h3 id="L665">field</h3>

<p>The field element contains data.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>header, footer</dd>
  <dt>Content Model</dt>
    <dd>marker-reference, string, current-page, evaluate (one or more)</dd>
</dl>
</div>

<h3 id="L683">marker-reference</h3>

<p>The marker-reference element indicates that it should resolve to the value
of a marker of the same class in the direction and scope specified by this
element.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>field</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>marker (required)</dt>
          <dd>The name of the marker to find.</dd>
        <dt>direction (required)</dt>
          <dd>One of 'forward', 'backward'</dd>
        <dt>scope (required)</dt>
          <dd>One of 'page_content', 'page', 'sequence'</dd>
      </dl>
    </dd>
  <dt>Content Model</dt>
    <dd>Empty.</dd>
</dl>
</div>

<h3 id="L696">string</h3>

<p>The string element indicates that it should resolve to the contents of its
value attribute.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>field</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>value (required)</dt>
          <dd>The string to output</dd>
      </dl>
    </dd>
  <dt>Content Model</dt>
    <dd>Empty.</dd>
</dl>
</div>

<h3 id="L709">current-page</h3>

<p>The current-page element indicates that it should resolve to the value of
the current page, using the number format specified by this element.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>field</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>style (required)</dt>
          <dd>'default', 'roman'</dd>
      </dl>
    </dd>
  <dt>Content Model</dt>
    <dd>Empty.</dd>
</dl>
</div>

<h3 id="L722">evaluate</h3>

<p>The evaluate element inserts the result of evaluating an expression, see the
<a href="#L507">OBFL evaluation language</a> for more information.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-entry, block, field</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>expression (required)</dt>
          <dd>A valid OBFL eveluation language expression.</dd>
      </dl>
    </dd>
  <dt>Content Model</dt>
    <dd>Emtpy.</dd>
</dl>
</div>

<h4>Example</h4>

<p><code>&lt;evaluate expression="(= 0 1)"/&gt;</code></p>

<h3 id="L735">table-of-contents</h3>

<p>The table-of-contents element defines the entries in a table of contents.
Note that this element only specifies formatting of data in a table of
contents, it does not by it self specify that a table of contents should be
inserted.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>obfl</dd>
  <dt>Content Model</dt>
    <dd>toc-entry (one or more)</dd>
</dl>
</div>

<h3 id="L1105">toc-entry</h3>

<p>The toc-entry element defines an entry in a table of contents.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>table-of-contents</dd>
   <dt>Attributes</dt>
   <dd>
	   <dl>
			<dt>ref-id</dt>
			<dd>The id of the block this entry is connected with.</dd>
		</dl>
   <p>This element supports the <a href="#borders">Borders</a> attribute group.</p></dd>
  <dt>Content Model</dt>
    <dd>text(), leader, marker, br, evaluate, toc-entry, page-number (zero or
      more)</dd>
</dl>
</div>

<h3 id="L1207">leader</h3>

<p>The leader element moves the location of the following piece of text within
the current row.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-entry, block</dd>
  <dt>Content Model</dt>
    <dd></dd>
</dl>
</div>

<h3 id="L1353">marker</h3>

<p>The marker element provides locations for classes of values that may be
refered to in headers and footers.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-entry, block</dd>
  <dt>Content Model</dt>
    <dd>Empty.</dd>
</dl>
</div>

<h3 id="L1438">br</h3>

<p>The br element provides a line break within a block of text (i.e. a
paragraph).</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-entry, block</dd>
  <dt>Content Model</dt>
    <dd>Empty.</dd>
</dl>
</div>

<h3 id="L836">page-number</h3>

<p>The page-number element inserts the current page number.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-entry, block</dd>
</dl>
</div>

<h3 id="L849">volume-template</h3>

<p>The volume-template element contains static contents that is to be inserted
before or after a braille volume's body of pages. In additional to the normal
sequences that can be used to create static contents such as information about
the author and title of the book, there is a special sequence called
toc-sequence.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>obfl</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>volume-count-variable</dt>
          <dd>definition of the name of the variable holding the number of
            volumes</dd>
        <dt>volume-number-variable</dt>
          <dd>definition of the name of the variable holding the current volume
            number</dd>
        <dt>use-when</dt>
          <dd>a condition for applying the volume template, expressed using the
            <a href="#L507">OBFL evaluation syntax</a></dd>
        <dt>sheets-in-volume-max</dt>
          <dd>defines the maximum number of sheets in a volume using this
            template</dd>
      </dl>
    </dd>
  <dt>Content Model</dt>
    <dd>pre-content (required)</dd>
    <dd>post-content (required)</dd>
</dl>
</div>

<h3 id="L870">pre-content</h3>

<p>The pre-content element defines contents that should preceed a braille
volume's body of pages.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>volume-template</dd>
  <dt>Content Model</dt>
    <dd>sequence, toc-sequence (zero or more)</dd>
</dl>
</div>

<h3 id="L888">post-content</h3>

<p>The post-content element defines contents that should follow a braille
volume's body of pages.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>volume-template</dd>
  <dt>Content Model</dt>
    <dd>sequence</dd>
</dl>
</div>

<h3 id="L906">sequence</h3>

<p>The sequence element contains the text body.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>volume-template, obfl</dd>
  <dt>Content Model</dt>
    <dd>block (one or more)</dd>
</dl>
</div>

<h3 id="L924">toc-sequence</h3>

<p>The toc-sequence element contains instructions needed to generate a TOC's
for braille books. Since the number of volumes and their contents is unknown
prior to the layout process and since the TOC in braille books may be different
for each volume, it is not sufficient to define the TOC before applying the
layout as in XSL-FO. Note that a toc-sequence only contains static contents
inserted while generating the toc (on-toc-start, on-volume-start, on-volume-end
and on-toc-end). The actual TOC entries are collected from the referenced toc
data.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>pre-content</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>master</dt>
          <dd>a reference to a page template (“layout-master”)</dd>
        <dt>toc</dt>
          <dd>a reference to TOC data (“table-of-contents”)</dd>
        <dt>range</dt>
          <dd>a data selection property (document/volume)</dd>
        <dt>use-when</dt>
          <dd>a condition for applying the toc-sequence</dd>
        <dt>initial-page-number</dt>
          <dd>the inital page number for the sequence</dd>
        <dt>xml:lang</dt>
          <dd>the default language of text descendants</dd>
        <dt>hyphenate</dt>
          <dd>whether or not to hyphenate text descendants</dd>
      </dl>
    </dd>
  <dt>Content Model</dt>
    <dd>on-toc-start (zero or more)</dd>
    <dd>on-volume-start (zero or more)</dd>
    <dd>on-volume-end (zero or more)</dd>
    <dd>on-toc-end (zero or more)</dd>
</dl>
</div>

<h3 id="L951">on-toc-start</h3>

<p>The on-toc-start element defines blocks of text to insert before the TOC
data.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-sequence</dd>
  <dt>Content Model</dt>
    <dd>block (one or more)</dd>
</dl>
</div>

<h3 id="L969">on-volume-start</h3>

<p>The on-volume-start element defines blocks of text to insert before the TOC
data of a volume. Note that this element only applies to document range
TOC's.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-sequence</dd>
  <dt>Content Model</dt>
    <dd>block (one or more)</dd>
</dl>
</div>

<h3 id="L987">on-volume-end</h3>

<p>The on-volume-end element defines blocks of text to insert after the TOC
data of a volume. Note that this element only applies to document range
TOC's.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-sequence</dd>
  <dt>Content Model</dt>
    <dd>block (one or more)</dd>
</dl>
</div>

<h3 id="L1005">on-toc-end</h3>

<p>The on-toc-end element defines blocks of text to insert after the TOC
data.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>toc-sequence</dd>
  <dt>Content Model</dt>
    <dd>block (one or more)</dd>
</dl>
</div>

<h3 id="L1023">block</h3>

<p>The block element defines a block of text.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>on-toc-start, on-volume-start, on-volume-end, on-toc-end, sequence</dd>
  <dt>Attributes</dt>
    <dd><dl>
        <dt>break-before ('auto', 'page')</dt>
          <dd>break before block begins</dd>
        <dt>first-line-indent (number)</dt>
          <dd>indent of the first line of a block (in characters)</dd>
        <dt>text-indent (number)</dt>
          <dd>indent of every line in the block except the first one (in
            characters)</dd>
        <dt>block-indent (number)</dt>
          <dd>indent of this block's block children (in characters)</dd>
        <dt>keep ('auto', 'all')</dt>
          <dd>keep rows in this block</dd>
        <dt>keep-with-next (number&lt;10)</dt>
          <dd>keep the following block's first line(s) together with this
          block</dd>
        <dt>list-type ('none', 'ol', 'ul', 'pl')</dt>
          <dd>the type of list for this block</dd>
        <dt>margin-bottom (number)</dt>
          <dd>bottom margin for this block (in rows)</dd>
        <dt>margin-left (number)</dt>
          <dd>left margin for this block (in characters)</dd>
        <dt>margin-top (number)</dt>
          <dd>top margin for this block (in rows)</dd>
        <dt>margin-right (number)</dt>
          <dd>right margin for this block (in characters)</dd>
      </dl>
      <p>This element supports the <a href="#borders">Borders</a> attribute group.</p>
    </dd>
  <dt>Content Model</dt>
    <dd>text(), leader, marker, br, evaluate, page-number (zero or more)</dd>
</dl>
</div>

<h3 id="L1194">content-items</h3>

<p>Defines items to be placed somewhere within the flow, typically as page
positioned elements, such as footnotes.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>obfl</dd>
  <dt>Content Model</dt>
    <dd>content-item (zero or more)</dd>
</dl>
</div>

<h3 id="L1210">content-item</h3>

<p>Defines the formatting of an item that should be inserted somewhere in the
flow. The behavior of this element is similar to the toc-entry element, except
that nesting of items is not allowed.</p>

<div class="sidebar">
<dl>
  <dt>Usage</dt>
    <dd>content-items</dd>
  <dt>Content Model</dt>
    <dd>block, text(), leader, marker, br, evaluate, page-number (zero or
    more)</dd>
</dl>
</div>

<p></p>

<h2>Attribute Groups</h2>
<h3 id="borders">Borders</h3>
<div class="sidebar">
<dl>
	 <dt>border-style ('none', 'solid')</dt>
          <dd>border style, sets the default border style</dd>
        <dt>border-bottom-style ('none', 'solid')</dt>
          <dd>border bottom style, overrides the default border style</dd>
        <dt>border-left-style ('none', 'solid')</dt>
          <dd>border left style, overrides the default border style</dd>
        <dt>border-top-style ('none', 'solid')</dt>
          <dd>border top style, overrides the default border style</dd>
        <dt>border-right-style ('none', 'solid')</dt>
          <dd>border right style, overrides the default border style</dd>
        <dt>border-width ('1', '2', '3', '4', '5', '6', '7', '8', '9')</dt>
          <dd>border width, sets the default border width. The default value is 1. Due to the limitations in expressiveness of text-only media, the meaning of the numbers are
	open to interpretation. 1 should be the thinnest possible value, 2 should be the double width 
	of 1, and so on. However, if it better matches the capabilities of the border characters, 2 
	could also mean the second thinnest possible border, and 3 the third thinnest border, and so on.</dd>
        <dt>border-bottom-width ('1', '2', '3', '4', '5', '6', '7', '8', '9')</dt>
          <dd>border bottom width, overrides the default border width</dd>
        <dt>border-left-width ('1', '2', '3', '4', '5', '6', '7', '8', '9'))</dt>
          <dd>border left width, overrides the default border width</dd>
        <dt>border-top-width ('1', '2', '3', '4', '5', '6', '7', '8', '9')</dt>
          <dd>border top width, overrides the default border width</dd>
        <dt>border-right-width ('1', '2', '3', '4', '5', '6', '7', '8', '9')</dt>
          <dd>border right width, overrides the default border width</dd>
        <dt>border-align ('inner', 'outer')</dt>
          <dd>border align, sets the default border align</dd>
        <dt>border-bottom-align ('inner', 'outer')</dt>
          <dd>border bottom align, overrides the default border align</dd>
        <dt>border-left-align ('inner', 'outer')</dt>
          <dd>border left align, overrides the default border align</dd>
        <dt>border-top-align ('inner', 'outer')</dt>
          <dd>border top align, overrides the default border align</dd>
        <dt>border-right-align ('inner', 'outer')</dt>
          <dd>border right align, overrides the default border align</dd>
</dl>
</div>
<h2 id="L756">Rule Sets</h2>

<p>The rule sets mentioned below are included in the <a href="obfl.zip">zip
file</a> for this specification. Users looking for local copies of the rule
sets to work with should download and use this archive rather than using the
specific references below.</p>

<h3 id="L763"><a name="Relax1" id="Relax1">DTD Rule Set</a></h3>

<p><strong>This section is normative.</strong></p>

<p>The DTD rule set "<a href="validation/obfl.dtd">validation/obfl.dtd</a>"
forms a normative part of this specification.</p>

<h3 id="L774">XML Schema Rule Set</h3>

<p><strong>This section is informative.</strong></p>

<p>The XML schema rule set "<a
href="validation/obfl.xsd">validation/obfl.xsd</a>" forms an informative part
of this specification.</p>

<h2 id="L784">References</h2>

<h3 id="L786">Normative References</h3>

<p><strong>This section is normative.</strong> </p>
<dl>
  <dt><a name="ref-digloss" id="ref-digloss"><strong>[DI
  Glossary]</strong></a></dt>
    <dd>"<a href="http://www.w3.org/TR/2005/WD-di-gloss-20050118/">Glossary of
      Terms for Device Independence</a>", Rhys Lewis, 18 January 2005.<br />
      <a href="http://www.w3.org/TR/di-gloss/">Latest version</a> available at:
      http://www.w3.org/TR/di-gloss/</dd>
  <dt><a name="ref-rfc21191"
  id="ref-rfc21191"><strong>[RFC2119]</strong></a></dt>
    <dd>"<a href="http://www.ietf.org/rfc/rfc2119.txt">RFC2119: Key words for
      use in RFCs to Indicate Requirement Levels</a>", S. Bradner, March
      1997.<br />
      Available at: http://www.ietf.org/rfc/rfc2119.txt</dd>
  <dt><a name="ref-unicode" id="ref-unicode"><strong>[Unicode]</strong></a></dt>
    <dd>"<a href="http://www.unicode.org/versions/Unicode5.1.0/">Unicode
      Standard, Version 5.1.0</a>", The Unicode Consortium. The Unicode
      Standard, Version 5.1.0, defined by: The Unicode Standard, Version 5.0
      (Boston, MA, Addison-Wesley, 2007. ISBN 0-321-48091-0), as amended by
      Unicode 5.1.0.<br />
      <a href="http://www.unicode.org/versions/latest/">Latest version</a>
      available at: http://www.unicode.org/versions/latest/</dd>
  <dt><a name="ref-xml" id="ref-xml"><strong>[XML]</strong></a></dt>
    <dd>"<a href="http://www.w3.org/TR/2006/REC-xml-20060816">Extensible Markup
      Language (XML) 1.0 (Fourth Edition)</a>", T. Bray, J. Paoli, C. M.
      Sperberg-McQueen, E. Maler, F. Yergeau, 29 September 2006.<br />
      <a href="http://www.w3.org/TR/xml">Latest version</a> available at:
      http://www.w3.org/TR/xml</dd>
  <dt><a name="ref-xmlns" id="ref-xmlns"><strong>[XMLNS]</strong></a></dt>
    <dd>"<a href="http://www.w3.org/TR/2006/REC-xml-names-20060816">Namespaces
      in XML 1.0 (Second Edition)</a>", T. Bray, D. Hollander, A. Layman, R.
      Tobin, 16 August 2006.<br />
      <a href="http://www.w3.org/TR/xml-names">Latest version</a> available at:
      http://www.w3.org/TR/xml-names</dd>
  <dt><a name="ref-xpath" id="ref-xpath"><strong>[XPath]</strong></a></dt>
    <dd>"<a href="http://www.w3.org/TR/1999/REC-xpath-19991116">XML Path
      Language (XPath) Version (1.0)"</a>, J. Clark, S. DeRose, 16 November
      1999.<br />
      <a href="http://www.w3.org/TR/xpath">Latest version</a> available at:
      http://www.w3.org/TR/xpath</dd>
</dl>

<h3 id="L881">Informative References</h3>

<p><strong>This section is informative.</strong></p>
<dl>
  <dt>[Example OBFL document: Example 1]</dt>
    <dd>"<a href="examples/example1.obfl">examples/example1.obfl</a>". A short
      OBFL example containing useage examples of most of the elements.</dd>
</dl>
</body>
</html>
